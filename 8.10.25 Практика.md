STRIDE для каждого комп, 5 угроз
к каждому способ защиты
Frontend, Backend API, БД, Payment Gateway

- **S**poofing (Подмена/Спуфинг)
    
- **T**ampering (Изменение/Фальсификация)
    
- **R**epudiation (Отказ от действий)
    
- **I**nformation Disclosure (Раскрытие информации)
    
- **D**enial of Service (Отказ в обслуживании)
    
- **E**levation of Privilege (Повышение привилегий)

1. **Frontend**:
- Spoofing - Злоумышленник выдает себя за юзера, украв данные его аккаунта | MFA или 2FA, капча, rate-limiting
- Tampering - Манипуляция HTTP-запросами(изменение цены товара) | Валидация данных в бэкенде
- Repudiation - Отказ пользователя в совершении действий | Ведение логов важных действий через бэкенд
- ID - Утечка данных через уязвимости, раскрытие инфы в ошибках | хранить API-ключи только в бэке
- EoP - Получение пользователем доступа к функционалу не для его роли | добавление Авторизации через бэк
2. **Backend AP**I:
- Spoofing - Подмена сервиса(фальшивый endpoint) | использование методов аутентификации (API, JWT, OAuth2.0)
- Tampering - условно, SQLI или же подмена данных между Front и Back | HTTPS(TLS) для шифрования трафика
- Repudiation - Админ или система отрицают выполнение операции, невозможно доказать совершение действия API | Защищенное логирование всех входящих запросов и исходящих ответов, включая метаданные аутентификации
- ID - Утечка данных из-за кривой настройки сервера, недостаточно контроля доступа к API или ошибок в логике | Шифрование конф. данных в БД, строгий контроль на уровне API(проверка прав эндпоинтом)
- DoS - Массовые запросы к API, тратящие ресурсы, приводящие к недоступности сервиса | Rate Limiting по IP, юзеру или токену + Firewall + сервисы защиты от DDoS(Cloudflare)
3. **БД**:
- Spoofing - Подмена клиента для доступа к БД | отказ от использования учеток по умолчанию, auth с помощью надежных паролей
- Tampering - Прямое изменение или удаление данных в БД мошенником | Принцип наименьших привилегий + резервное копирование БД
- Repudiation - Админ БД отрицает внесение изменений | Включить аудит в БД, логирование всех действий админа и запросов
- ID - Прямой доступ к БД, кража данных | Шифрование на REST, шифрование хранилища БД
- EoP - Получение прав админа через уязвимость или ошибку конфига | Строгое разделение прав
4. **Payment Gateway**:
- Spoofing - Маскировка сайта под легитимный платежный шлюз для кражи данных карты | Использование официальных и проверенных SDK и API для платежки 
- Tampering - Изменение данных платежного запроса | Взаимодействия происходят по HTTPS/mTLS(подписание запросов секретным ключом)
- Repudiation - Клиент отрицает совершение платежа, или платежная система не подтверждает его проведение | Ведение детального аудита на вашей стороне с сохранением `payment_id`, статусов и всех метаданных
- ID - Перехват платежных данных при передаче или хранении | Токенизация платежных данных: бэкенд никогда не видит и не хранит данные карты, получая от шлюза только токен для повторных списаний
- DoS - Атака на платежный шлюз, делающая его недоступным. Приложение не может обрабатывать платеж | Наличие fallback-платежного провайдера, настройка мониторинга доступности шлюза и таймаутов в вашем приложении, чтобы не блокировать пользовательские сессии