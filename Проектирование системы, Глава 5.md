### **Системное проектирование на собеседованиях**

  

**Системное проектирование** — это обширная тема, а собеседования по нему оценивают вашу способность создавать технические решения для абстрактных проблем. Они не предполагают единственно правильного ответа.

  

**Ключевые этапы собеседования:**

  

1. **Уточнение требований**

   - **Функциональные:** Основные возможности системы (что система должна делать)

   - **Нефункциональные:** Качественные ограничения (масштабируемость, надежность, безопасность)

   - **Дополнительные:** "Приятные возможности" за рамками основной функциональности

  

2. **Оценка масштаба и ограничений**

   - Количество пользователей

   - RPS (запросов в секунду)

   - Объемы хранения данных

   - Пропускная способность

  

3. **Проектирование модели данных**

   - Определение сущностей и их взаимосвязей

   - Выбор типа базы данных (SQL/NoSQL)

  

4. **Проектирование API**

   - Определение интерфейсов без написания кода

   - Параметры, возвращаемые значения

  

5. **Высокоуровневое проектирование компонентов**

   - Выбор архитектуры (монолит/микросервисы)

   - Определение основных компонентов системы

  

6. **Детальное проектирование**

   - Углубление в ключевые компоненты

   - Обсуждение решений и компромиссов

  

7. **Выявление и устранение узких мест**

   - Анализ единых точек отказа

   - План масштабирования и отказоустойчивости

  

---

  

### **Сервис сокращения URL**

  

**Что это:** Сервис для создания коротких псевдонимов для длинных URL-адресов.

  

**Пример:**

- Длинный: `https://example.com/very/long/url/path`

- Короткий: `https://short.ly/abc123`

  

**Требования:**

- Создание коротких ссылок

- Редирект на оригинальный URL

- Время жизни ссылок

- Высокая доступность и низкая задержка

  

**Масштаб:**

- 100 млн новых ссылок в месяц

- 4K редиректов в секунду

- 6 TB хранилища за 10 лет

  

**Ключевые решения:**

- **Генерация ключей:** Base62, MD5, счетчики с Zookeeper

- **Кэширование:** Redis/Memcached с политикой LRU

- **Партиционирование:** Consistent Hashing

- **Очистка:** Активная (cron) и пассивная (при доступе)

  

---

  

### **WhatsApp (мессенджер)**

  

**Что это:** Приложение для мгновенного обмена сообщениями.

  

**Требования:**

- Личные и групповые чаты (до 100 человек)

- Обмен файлами

- Статусы доставки и прочтения

- Push-уведомления

  

**Масштаб:**

- 50 млн активных пользователей в день

- 2 млрд сообщений в день

- 24K RPS

- 38 PB хранилища за 10 лет

  

**Ключевые решения:**

- **Архитектура:** Микросервисы (User, Chat, Notification, Presence, Media)

- **Обмен сообщениями:** WebSockets для реального времени

- **Статусы онлайн:** Heartbeat-механизм

- **Уведомления:** Очереди сообщений + FCM/APNS

- **Хранение файлов:** Объектные хранилища (S3)

- **CDN:** Для статических медиафайлов

  

---

  

### **Twitter (социальная сеть)**

  

**Что это:** Платформа для публикации коротких сообщений (твитов).

  

**Требования:**

- Публикация твитов (текст, изображения, видео)

- Подписки на пользователей

- Лента новостей

- Поиск твитов

  

**Масштаб:**

- 200 млн активных пользователей в день

- 1 млрд твитов в день

- 12K RPS

- 19 PB хранилища за 10 лет

  

**Ключевые решения:**

- **Лента новостей:**

  - Pull Model (fan-out on load)

  - Push Model (fan-out on write)

  - Hybrid Model (комбинированный)

- **Ранжирование:** Machine Learning алгоритмы

- **Поиск:** Elasticsearch

- **Тренды:** Кэширование популярных запросов

- **Ретвиты:** Отдельная таблица или модификация типа твита

  

---

  

### **Netflix (видеостриминг)**

  

**Что это:** Сервис потоковой передачи видео по подписке.

  

**Требования:**

- Стриминг видео

- Загрузка контента

- Поиск видео

- Комментарии к видео

  

**Масштаб:**

- 200 млн активных пользователей в день

- 1 млрд просмотров в день

- 12K RPS

- 1,825 PB хранилища за 10 лет

  

**Ключевые решения:**

- **Обработка видео:**

  - Чанкование по сценам

  - Контент-фильтрация

  - Транскодинг (FFmpeg)

  - Конвертация качества

- **Стриминг:** CDN (Open Connect), HLS

- **Геоблокировка:** CloudFront Geographic Restrictions

- **Рекомендации:** Collaborative Filtering + Netflix Algorithm

- **Поиск:** Elasticsearch

  

---

  

### **Uber (сервис такси)**

  

**Что это:** Платформа для заказа поездок.

  

**Требования:**

- Поиск ближайших водителей

- Бронирование поездок

- Отслеживание местоположения

- Оплата и рейтинги

  

**Масштаб:**

- 100 млн активных пользователей в день

- 10 млн поездок в день

- 12K RPS

- 1.4 PB хранилища за 10 лет

  

**Ключевые решения:**

- **Отслеживание местоположения:** WebSockets

- **Поиск водителей:**

  - Геохеширование

  - Квадродеревья

  - In-memory кэш (Redis)

- **Совпадение поездок:** Mutex для избежания race conditions

- **Динамическое ценообразование:** Surge Pricing

- **Платежи:** Интеграция со Stripe/PayPal

- **Уведомления:** Очереди + FCM/APNS

  

**Общие паттерны для всех систем:**

- Микросервисная архитектура

- Горизонтальное масштабирование

- Кэширование (Redis/Memcached)

- Партиционирование данных (Sharding)

- Балансировка нагрузки

- Резервное копирование и репликация

- Мониторинг и аналитика

  

Каждая система требует тщательного анализа компромиссов между согласованностью, доступностью и стоимостью реализации.